% files={'/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy1_20220405_raw_radial1D,weighted,fixed=[0,0,1,1,1,1,0,],fixedparamval=[1300,0.3,1,1,1,0,2640,],kevindata,threshold=-1,tskip=1,xskip=1,2.mat',
%        '/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy1_20220405_raw_radial1D,weighted,fixed=[0,0,1,1,1,0,0,],fixedparamval=[1336,0.266,1,1,1,0.01,2647,],kevindata,threshold=-1,tskip=1,xskip=1,5.mat',
%        '/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy1_20220405_raw_radial1D,weighted,fixed=[0,0,1,1,0,1,0,],fixedparamval=[1300,0.3,1,1,1,0,2640,],kevindata,threshold=-1,tskip=1,xskip=1,3.mat',
%        '/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy1_20220405_raw_radial1D,weighted,fixed=[0,0,0,0,1,1,0,],fixedparamval=[1691,0.18,1,0.7,1,0,2587,],kevindata,threshold=-1,tskip=1,xskip=1,4.mat',};

% files={'/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy2_20220405_raw_radial1D,weighted,fixed=[0,0,1,1,1,1,0,],fixedparamval=[1300,0.3,1,1,1,0,2640,],kevindata,threshold=-1,tskip=1,xskip=1,2.mat',
%        '/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy2_20220405_raw_radial1D,weighted,fixed=[0,0,1,1,1,0,0,],fixedparamval=[1336,0.26,1,1,1,0.14,2612,],kevindata,threshold=-1,tskip=1,xskip=1,5.mat',
%        '/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy2_20220405_raw_radial1D,weighted,fixed=[0,0,1,1,0,1,0,],fixedparamval=[1112,0.31,1,1,0.83,0,2595,],kevindata,threshold=-1,tskip=1,xskip=1,5.mat',
%        '/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy2_20220405_raw_radial1D,weighted,fixed=[0,0,0,0,1,1,0,],fixedparamval=[1080,0.17,1.1,1.6,1,0,2800,],kevindata,threshold=-1,tskip=1,xskip=1,4.mat',};

% files={'/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy5_20220405_raw_radial1D,weighted,fixed=[0,0,1,1,1,1,0,],fixedparamval=[1500,0.3,1,1,1,0,2600,],kevindata,threshold=-1,tskip=1,xskip=1,3.mat',
%        '/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy5_20220405_raw_radial1D,weighted,fixed=[0,0,1,1,1,0,0,],fixedparamval=[1500,0.3,1,1,1,0.05,2600,],kevindata,threshold=-1,tskip=1,xskip=1,3.mat',
%        '/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy5_20220405_raw_radial1D,weighted,fixed=[0,0,1,1,0,1,0,],fixedparamval=[1670,0.19,1,1,1,0,2600,],kevindata,threshold=-1,tskip=1,xskip=1,3.mat',
%        '/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy5_20220405_raw_radial1D,weighted,fixed=[0,0,0,0,1,1,0,],fixedparamval=[1300,0.3,1,1,1,0,2600,],kevindata,threshold=-1,tskip=1,xskip=1,2.mat',};

% files={'/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy6_20220405_raw_radial1D,weighted,fixed=[0,0,1,1,1,1,0,],fixedparamval=[1280,0.277,1,1,1,0,2885,],kevindata,threshold=-1,tskip=1,xskip=1,3.mat',
%        '/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy6_20220405_raw_radial1D,weighted,fixed=[0,0,1,1,1,0,0,],fixedparamval=[1460,0.277,1,1,1,0.05,2830,],kevindata,threshold=-1,tskip=1,xskip=1,3.mat',
%        '/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy6_20220405_raw_radial1D,weighted,fixed=[0,0,1,1,0,1,0,],fixedparamval=[1700,0.19,1,1,1,0,2800,],kevindata,threshold=-1,tskip=1,xskip=1,3.mat',
%        '/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy5_20220405_raw_radial1D,weighted,fixed=[0,0,0,0,1,1,0,],fixedparamval=[1300,0.3,1,1,1,0,2600,],kevindata,threshold=-1,tskip=1,xskip=1,2.mat',};

files={'/home/liuy1/Documents/woundhealing/simulations/kevindata_20220405_radial_nonoisescaling/kevindata_circle_xy1_20220405_raw_radial1D,fixed=[0,0,1,1,1,1,0,],fixedparamval=[1340,0.26,1,1,1,0,2600,],kevindata,threshold=-1,tskip=1,xskip=1,2.mat',
       '/home/liuy1/Documents/woundhealing/simulations/kevindata_20220405_radial_nonoisescaling/kevindata_circle_xy1_20220405_raw_radial1D,fixed=[0,0,1,1,1,0,0,],fixedparamval=[930,0.26,1,1,1,0,2600,],kevindata,threshold=-1,tskip=1,xskip=1,2.mat',
       '/home/liuy1/Documents/woundhealing/simulations/kevindata_20220405_radial_nonoisescaling/kevindata_circle_xy1_20220405_raw_radial1D,fixed=[0,0,1,1,0,1,0,],fixedparamval=[1022,0.4,1,1,1,0,2600,],kevindata,threshold=-1,tskip=1,xskip=1,2.mat',
       '/home/liuy1/Documents/woundhealing/simulations/kevindata_20220405_radial_nonoisescaling/kevindata_circle_xy1_20220405_raw_radial1D,fixed=[0,0,0,0,1,1,0,],fixedparamval=[1022,0.4,1,1,1,0,2880,],kevindata,threshold=-1,tskip=1,xskip=1,2.mat',};

   
load(files{1});
params=fixed_param_val;
params(fixed==0)=overall_minimizer;
[~,cc_rDk,~,~] = woundhealing_1d(params,numeric_params,0,ic,rs);

load(files{2});
params=fixed_param_val;
params(fixed==0)=overall_minimizer;
[~,cc_rDnk,~,~] = woundhealing_1d(params,numeric_params,0,ic,rs);

load(files{3})
params=fixed_param_val;
params(fixed==0)=overall_minimizer;
[~,cc_rDgk,~,~] = woundhealing_1d(params,numeric_params,0,ic,rs);

load(files{4})
params=fixed_param_val;
params(fixed==0)=overall_minimizer;
[~,cc_rDabk,~,~] = woundhealing_1d(params,numeric_params,0,ic,rs);

fig=animate_mult_1d({noisy_data,cc_rDk,cc_rDnk,cc_rDgk,cc_rDabk},[0,max(rs)],[0,3500],1/3,{'data','rDk model','rDnk model','rDgk model','rDabk model'},'simulations/kevindata_20220405_radial_nonoisescaling/kevindata_circle_xy1_20220405_raw_radial1D,comparison',1);

%%
load('/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy1_20220405_raw.mat');
noisy_data=C_radial_avg;
ic=noisy_data(1,:)';
nFrame=size(noisy_data,1);
T=(nFrame-1)*dt+0.001;% helps with off-by-1 rounding
dt=1/3;
numeric_params=[T, dt/100, 100, NaN, NaN, 1];
[~,cc1,~,~] = woundhealing_1d([1300,0.27,1,1,0.6,0,2600],numeric_params,0,ic,rs);
[~,cc2,~,~] = woundhealing_1d([1300,0.27,1,1,  1,0,2600],numeric_params,0,ic,rs);
[~,cc3,~,~] = woundhealing_1d([1300,0.27,1,1,  2,0,2600],numeric_params,0,ic,rs);
[~,cc4,~,~] = woundhealing_1d([1300,0.27,1,1,  9,0,2600],numeric_params,0,ic,rs);
fig=animate_mult_1d({cc1,cc2,cc3,cc4},[0,max(rs)],[0,3500],1/3,{'gamma=0.6','1','2','9'},'simulations/gamma_comparison',1);

%%
load('/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy1_20220405_raw_radial1D,weighted,fixed=[0,0,1,1,0,1,0,],fixedparamval=[1300,0.3,1,1,1,0,2640,],kevindata,threshold=-1,tskip=1,xskip=1,3.mat');
data1=noisy_data;
params=fixed_param_val;
params(fixed==0)=overall_minimizer;
[~,model1,~,~] = woundhealing_1d(params,numeric_params,0,ic,rs);

load('/home/liuy1/Documents/woundhealing/simulations/kevindata_circle_xy2_20220405_raw_radial1D,weighted,fixed=[0,0,1,1,0,1,0,],fixedparamval=[1112,0.31,1,1,0.83,0,2595,],kevindata,threshold=-1,tskip=1,xskip=1,5.mat');
data2=noisy_data;
params=fixed_param_val;
params(fixed==0)=overall_minimizer;
[~,model2,~,~] = woundhealing_1d(params,numeric_params,0,ic,rs);

fig=animate_mult_1d({data1,model1,data2,model2},[0,max(rs)],[0,3500],1/3,{'data1','model1','data2','model2'},'simulations/xy1_xy2_rDgk_comparison',1);
